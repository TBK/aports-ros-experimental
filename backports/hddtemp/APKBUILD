# Contributor: Atsushi Watanabe <atsushi.w@ieee.org>
# Maintainer:
pkgname=hddtemp
pkgver=0.3_beta15
_pkgver=0.3-beta15
pkgrel=0
pkgdesc="hard drive temperature monitoring utility"
url="https://logging.apache.org/hddtemp/latest_stable/index.html"
arch="all"
license="GPL-2"
depends=""
makedepends="linux-headers"
subpackages="$pkgname-doc"
source="$pkgname-$_pkgver.tar.bz2::http://download.savannah.nongnu.org/releases/$pkgname/$pkgname-$_pkgver.tar.bz2"

builddir="$srcdir"/$pkgname-$_pkgver

build() {
	cd "$builddir"

	mkdir -p build && cd build
	../configure \
		--prefix=/usr \
		CFLAGS="-Os -Wno-narrowing"
	make
}

check() {
	cd "$builddir"/build
	make check
}

package() {
	cd "$builddir"/build
	make DESTDIR="$pkgdir" install

  rm -rf "$pkgdir"/usr/share/locale "$pkgdir"/usr/lib/charset.alias
  find "$pkgdir"/usr/man -type f | xargs gzip

	install -d -m 0755 "$pkgdir"/usr/share/licenses/hddtemp
	install -m 0644 "$builddir"/LICENSE "$pkgdir"/usr/share/licenses/hddtemp
}
